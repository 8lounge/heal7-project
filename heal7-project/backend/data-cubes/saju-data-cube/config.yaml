# ğŸ”® HEAL7 ì‚¬ì£¼ ë°ì´í„°íë¸Œ ì„¤ì •
# ì‚¬ì£¼ëª…ë¦¬í•™ ë°ì´í„°ì˜ ì™„ì „í•œ ìº¡ìŠí™” ë° ê´€ë¦¬

cube_info:
  name: "saju-data-cube"
  version: "2.0.0"
  description: "ì‚¬ì£¼ëª…ë¦¬í•™ ê³„ì‚°, í•´ì„, ê¶í•© ë¶„ì„ ë°ì´í„° ì²˜ë¦¬ íë¸Œ"
  maintainer: "HEAL7 ì‚¬ì£¼íŒ€"
  created_at: "2024-03-15"
  category: "core_service"

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
database:
  postgresql:
    schema_name: "saju_service"
    description: "ì‚¬ì£¼ ê³„ì‚° ê²°ê³¼, ëŒ€ìš´/ì„¸ìš´, ê¶í•© ë¶„ì„ ë°ì´í„°"
    tables:
      - "saju_charts"          # ì‚¬ì£¼ ì°¨íŠ¸ ê¸°ë³¸ ì •ë³´
      - "daewoon_cycles"       # ëŒ€ìš´ ì •ë³´
      - "sewoon_cycles"        # ì„¸ìš´ ì •ë³´  
      - "compatibility_analyses" # ê¶í•© ë¶„ì„ ê²°ê³¼
      - "calculation_performance" # ì„±ëŠ¥ ë¡œê·¸
    pool_size: 20
    max_overflow: 30
    
  redis:
    db_number: 1
    namespace: "saju_service"
    description: "ì‚¬ì£¼ ê³„ì‚° ê²°ê³¼ ìºì‹œ, KASI ë°ì´í„° ìºì‹œ"
    key_patterns:
      - "saju_service:chart:{chart_id}"
      - "saju_service:daewoon:{chart_id}"
      - "saju_service:kasi:*"
      - "saju_service:compatibility:*"
    connection_pool: 15
    default_ttl: 604800  # 7 days
    
  jsonb:
    enabled: false
    reason: "ì‚¬ì£¼ ë°ì´í„°ëŠ” ì •ê·œí™”ëœ ê´€ê³„í˜• êµ¬ì¡° ì‚¬ìš©"

# API ì¸í„°í˜ì´ìŠ¤ ì„¤ì •
interfaces:
  rest_api:
    enabled: true
    port: 8001
    prefix: "/api/v1/saju"
    endpoints:
      - "/charts"              # ì‚¬ì£¼ ì°¨íŠ¸ ì¡°íšŒ/ìƒì„±
      - "/compatibility"       # ê¶í•© ë¶„ì„
      - "/fortune"            # ìš´ì„¸ ì¡°íšŒ
      - "/cache"              # ìºì‹œ ê´€ë¦¬
    
  message_queue:
    enabled: true
    topics:
      subscribe:
        - "user.created"        # ìƒˆ ì‚¬ìš©ì ìƒì„± ì‹œ
        - "user.updated"        # ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œ
      publish:
        - "saju.calculation.completed"  # ì‚¬ì£¼ ê³„ì‚° ì™„ë£Œ
        - "saju.cache.invalidated"     # ìºì‹œ ë¬´íš¨í™”
    
  grpc:
    enabled: false
    reason: "í˜„ì¬ëŠ” REST APIë§Œ ì‚¬ìš©"

# ë°ì´í„° ì²˜ë¦¬ ì„¤ì •
processing:
  saju_calculation:
    enabled: true
    engine_version: "2.0.0"
    kasi_api_integration: true
    cache_results: true
    
  compatibility_analysis:
    enabled: true
    analysis_types: ["romantic", "business", "friendship"]
    detailed_scoring: true
    
  performance_optimization:
    parallel_processing: true
    batch_size: 100
    cache_warming: true

# ì™¸ë¶€ ì˜ì¡´ì„±
dependencies:
  cubes:
    - name: "shared-data-cube"
      reason: "ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ"
      endpoints: ["/users", "/sessions"]
  
  external_apis:
    - name: "KASI API"
      url: "https://kasi.re.kr/api"
      description: "ì ˆê¸° ë° ìŒë ¥ ë³€í™˜ ë°ì´í„°"
      rate_limit: "1000/hour"

# ëª¨ë‹ˆí„°ë§ ì„¤ì •
monitoring:
  metrics_enabled: true
  health_check_interval: 30
  performance_logging: true
  
  alerts:
    calculation_latency_threshold: 5000  # ms
    cache_hit_rate_threshold: 0.8       # 80%
    database_connection_threshold: 0.9   # 90%
  
  dashboards:
    - "ì‚¬ì£¼ ê³„ì‚° ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ"
    - "ìºì‹œ íš¨ìœ¨ì„± ëŒ€ì‹œë³´ë“œ"
    - "KASI API ì‚¬ìš©ëŸ‰ ëŒ€ì‹œë³´ë“œ"

# ë³´ì•ˆ ì„¤ì •
security:
  encryption_enabled: true
  encryption_algorithm: "AES-256"
  
  access_control: "role_based"
  allowed_roles: ["saju_service", "dashboard_service", "admin"]
  
  audit_logging: true
  sensitive_fields: ["birth_time", "birth_location"]
  
  api_authentication: "jwt_token"
  rate_limiting:
    requests_per_minute: 1000
    requests_per_hour: 10000

# ë°±ì—… ë° ë³µêµ¬
backup:
  auto_backup: true
  backup_interval: "daily"
  backup_time: "02:00"
  retention_days: 30
  
  backup_targets:
    postgresql: true
    redis: true  # ì¤‘ìš”í•œ ìºì‹œ ë°ì´í„°ë§Œ
    
  restore_testing: "weekly"

# ì„±ëŠ¥ ìµœì í™”
performance:
  connection_pooling: true
  query_optimization: true
  index_maintenance: "auto"
  
  cache_strategies:
    - "calculation_results"      # ê³„ì‚° ê²°ê³¼ ìºì‹œ
    - "frequent_queries"        # ìì£¼ ì¡°íšŒë˜ëŠ” ì¿¼ë¦¬
    - "kasi_api_responses"      # KASI API ì‘ë‹µ
  
  scaling:
    horizontal_scaling: false   # í˜„ì¬ëŠ” ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤
    vertical_scaling: true
    max_memory: "2GB"
    max_cpu_cores: 4

# ë°ì´í„° í’ˆì§ˆ
data_quality:
  validation_enabled: true
  validation_rules:
    - "birth_date_range_check"   # ì¶œìƒì¼ì ìœ íš¨ì„±
    - "saju_structure_integrity" # ì‚¬ì£¼ êµ¬ì¡° ë¬´ê²°ì„±
    - "calculation_consistency"  # ê³„ì‚° ì¼ê´€ì„±
  
  cleanup_policies:
    - name: "old_cache_cleanup"
      schedule: "daily"
      action: "delete_expired_cache"
    - name: "performance_log_rotation"  
      schedule: "weekly"
      action: "archive_old_logs"

# ê°œë°œ í™˜ê²½
development:
  debug_mode: false
  test_data_enabled: true
  mock_kasi_api: false
  
  test_configurations:
    unit_tests: true
    integration_tests: true
    performance_tests: true
    
# ìš´ì˜ í™˜ê²½
production:
  high_availability: true
  load_balancing: false  # í–¥í›„ êµ¬í˜„
  disaster_recovery: true
  
  maintenance_windows:
    - day: "Sunday"
      time: "03:00-04:00"
      description: "ì£¼ê°„ ì •ê¸° ì ê²€"