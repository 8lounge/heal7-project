/**
 * 사주명리학 핵심 상수 모듈
 * ===========================
 * 
 * 전통 명리학 기준의 모든 상수 정의
 * - 60갑자 순환
 * - 천간/지지 배열
 * - 오행 매핑
 * - 기준점 상수
 */

// 🔥 만세력 핵심 상수 기준값 (CRITICAL CONSTANTS)
export const GAPJA_REFERENCE_CONSTANTS = {
  /**
   * 🔥 60갑자 절대 기준일: 1900년 1월 31일 = 갑진일
   * ⚠️  이 값을 변경하면 모든 만세력 계산이 틀어짐
   * 📚 출처: 전통 명리학 표준, KASI API 호환
   */
  REFERENCE_DATE: new Date(1900, 0, 31), // 1900년 1월 31일
  REFERENCE_GAPJA: '갑진',
  REFERENCE_GAPJA_INDEX: 40, // 갑자60순환 배열에서의 위치

  /**
   * 🔥 입춘 기준 (연주 계산의 핵심)
   * ⚠️  매년 2월 4일 전후가 입춘이며, 이 기준으로 연주가 바뀜
   */
  SPRING_START_MONTH: 2,
  SPRING_START_DAY: 4,
} as const;

// 🎯 진태양시 계산 상수 (국가별 지역 기준)
export const SOLAR_TIME_CONSTANTS = {
  /**
   * 🔥 한국(서울) 기준 진태양시 보정
   * 위도: 37.5665°N, 경도: 126.9780°E (서울 중심)
   * 표준 경도: 135°E (동경 135도 - 한국표준시)
   * 보정값: (126.978 - 135) × 4분/도 = -32.09분 ≈ -32분
   */
  KOREA_LONGITUDE: 126.978,
  KOREA_STANDARD_LONGITUDE: 135.0,
  KOREA_TIME_CORRECTION_MINUTES: -32, // 서울 표준시 기준 경도차 보정

  /**
   * 🔥 다른 국가 확장용 (향후 글로벌 서비스 대비)
   */
  CHINA_LONGITUDE: 116.4074, // 베이징
  CHINA_TIME_CORRECTION_MINUTES: -46,
  JAPAN_LONGITUDE: 139.6917, // 도쿄
  JAPAN_TIME_CORRECTION_MINUTES: 19,
} as const;

// 천간 데이터 (10개)
export const 천간 = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'];

// 지지 데이터 (12개)
export const 지지 = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'];

// 12지신 동물 매핑
export const 띠동물: Record<string, string> = {
  '자': '쥐', '축': '소', '인': '호랑이', '묘': '토끼',
  '진': '용', '사': '뱀', '오': '말', '미': '양',
  '신': '원숭이', '유': '닭', '술': '개', '해': '돼지'
};

// 오행 매핑
export const 오행매핑: Record<string, string> = {
  '갑': '목', '을': '목', '병': '화', '정': '화', '무': '토',
  '기': '토', '경': '금', '신': '금', '임': '수', '계': '수'
};

// 완전한 60갑자 배열 (정확한 순서, 존재하지 않는 조합 방지)
export const 갑자60순환 = [
  // 1-10
  '갑자', '을축', '병인', '정묘', '무진', '기사', '경오', '신미', '임신', '계유',
  // 11-20
  '갑술', '을해', '병자', '정축', '무인', '기묘', '경진', '신사', '임오', '계미',
  // 21-30
  '갑신', '을유', '병술', '정해', '무자', '기축', '경인', '신묘', '임진', '계사',
  // 31-40
  '갑오', '을미', '병신', '정유', '무술', '기해', '경자', '신축', '임인', '계묘',
  // 41-50
  '갑진', '을사', '병오', '정미', '무신', '기유', '경술', '신해', '임자', '계축',
  // 51-60
  '갑인', '을묘', '병진', '정사', '무오', '기미', '경신', '신유', '임술', '계해'
];

// 🔥 60갑자 한글↔한자 매핑 (캘린더 표시용)
export const 갑자한자매핑: Record<string, string> = {
  // 1-10
  '갑자': '甲子', '을축': '乙丑', '병인': '丙寅', '정묘': '丁卯', '무진': '戊辰',
  '기사': '己巳', '경오': '庚午', '신미': '辛未', '임신': '壬申', '계유': '癸酉',
  // 11-20
  '갑술': '甲戌', '을해': '乙亥', '병자': '丙子', '정축': '丁丑', '무인': '戊寅',
  '기묘': '己卯', '경진': '庚辰', '신사': '辛巳', '임오': '壬午', '계미': '癸未',
  // 21-30
  '갑신': '甲申', '을유': '乙酉', '병술': '丙戌', '정해': '丁亥', '무자': '戊子',
  '기축': '己丑', '경인': '庚寅', '신묘': '辛卯', '임진': '壬辰', '계사': '癸巳',
  // 31-40
  '갑오': '甲午', '을미': '乙未', '병신': '丙申', '정유': '丁酉', '무술': '戊戌',
  '기해': '己亥', '경자': '庚子', '신축': '辛丑', '임인': '壬寅', '계묘': '癸卯',
  // 41-50
  '갑진': '甲辰', '을사': '乙巳', '병오': '丙午', '정미': '丁未', '무신': '戊申',
  '기유': '己酉', '경술': '庚戌', '신해': '辛亥', '임자': '壬子', '계축': '癸丑',
  // 51-60
  '갑인': '甲寅', '을묘': '乙卯', '병진': '丙辰', '정사': '丁巳', '무오': '戊午',
  '기미': '己未', '경신': '庚申', '신유': '辛酉', '임술': '壬戌', '계해': '癸亥'
};

// 🔥 60갑자 표시 헬퍼 함수 (한글 + 한자 괄호)
export const get갑자표시 = (koreanGapja: string): string => {
  const chineseChar = 갑자한자매핑[koreanGapja];
  if (chineseChar) {
    return `${koreanGapja} (${chineseChar})`;
  }
  return koreanGapja; // 매핑이 없으면 한글만 표시
};

// 손없는날 계산을 위한 기준 데이터
export const 손없는날기준 = {
  // 1월 손없는날: 9, 10, 21, 22일
  1: [9, 10, 21, 22],
  // 2월 손없는날: 5, 6, 17, 18일
  2: [5, 6, 17, 18],
  // 3월 손없는날: 5, 6, 17, 18일
  3: [5, 6, 17, 18],
  // 4월 손없는날: 1, 2, 13, 14일
  4: [1, 2, 13, 14],
  // 5월 손없는날: 1, 2, 13, 14일
  5: [1, 2, 13, 14],
  // 6월 손없는날: 9, 10, 21, 22일
  6: [9, 10, 21, 22],
  // 7월 손없는날: 9, 10, 21, 22일
  7: [9, 10, 21, 22],
  // 8월 손없는날: 5, 6, 17, 18일
  8: [5, 6, 17, 18],
  // 9월 손없는날: 5, 6, 17, 18일
  9: [5, 6, 17, 18],
  // 10월 손없는날: 1, 2, 13, 14일
  10: [1, 2, 13, 14],
  // 11월 손없는날: 1, 2, 13, 14일
  11: [1, 2, 13, 14],
  // 12월 손없는날: 9, 10, 21, 22일
  12: [9, 10, 21, 22],
};

// 길일/흉일 판정을 위한 기준 데이터
export const 길흉판정기준 = {
  길일: {
    갑자: ['자', '축', '인'],
    을축: ['묘', '진', '사'],
    병인: ['오', '미', '신'],
    // ... 더 많은 매핑 필요
  },
  흉일: {
    갑자: ['미', '신', '유'],
    을축: ['술', '해', '자'],
    병인: ['축', '인', '묘'],
    // ... 더 많은 매핑 필요
  }
};

// 24절기 매핑 (대략적인 날짜)
export const 절기매핑: Record<string, { month: number; day: number }> = {
  '입춘': { month: 2, day: 4 },
  '우수': { month: 2, day: 19 },
  '경칩': { month: 3, day: 6 },
  '춘분': { month: 3, day: 21 },
  '청명': { month: 4, day: 5 },
  '곡우': { month: 4, day: 20 },
  '입하': { month: 5, day: 6 },
  '소만': { month: 5, day: 21 },
  '망종': { month: 6, day: 6 },
  '하지': { month: 6, day: 21 },
  '소서': { month: 7, day: 7 },
  '대서': { month: 7, day: 23 },
  '입추': { month: 8, day: 8 },
  '처서': { month: 8, day: 23 },
  '백로': { month: 9, day: 8 },
  '추분': { month: 9, day: 23 },
  '한로': { month: 10, day: 8 },
  '상강': { month: 10, day: 24 },
  '입동': { month: 11, day: 7 },
  '소설': { month: 11, day: 22 },
  '대설': { month: 12, day: 7 },
  '동지': { month: 12, day: 22 },
  '소한': { month: 1, day: 6 },
  '대한': { month: 1, day: 21 },
};

// 운세 점수 계산을 위한 기준 데이터
export const 운세점수기준 = {
  매우좋음: 5,
  좋음: 4,
  보통: 3,
  주의: 2,
  불길: 1
};

// 색상 매핑 (UI 표시용)
export const 오행색상매핑: Record<string, string> = {
  '목': '#22c55e', // 초록
  '화': '#ef4444', // 빨강
  '토': '#a3a3a3', // 회색
  '금': '#ffd700', // 금색
  '수': '#3b82f6'  // 파랑
};

// 유효성 검사 함수들
export const is유효한60갑자 = (gapja: string): boolean => {
  return 갑자60순환.includes(gapja);
};

export const is유효한천간 = (cheongan: string): boolean => {
  return 천간.includes(cheongan);
};

export const is유효한지지 = (jiji: string): boolean => {
  return 지지.includes(jiji);
};